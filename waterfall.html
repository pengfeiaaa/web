<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>瀑布流图片</title>
<style>
*{margin:0 ;padding:0}
#wrap{position:relative;}
.box{padding:10px 0 0 10px;float:left;}
.pic{padding:10px;border:solid 1px #ccc;box-shadow:0px 0px 5px #aaa;}
.pic img{width:250px;height:auto;}
</style>
<script>
	window.onload=function(){
		 waterfall();
									
		}
	function waterfall(){
		var parent=document.getElementById('wrap');
		var box=getbyCls(parent,'box');
	    var winWidth = window.innerWidth || document.body.clientWidth; //获取可视窗口的大小
		var colNum=Math.floor(winWidth/box[0].offsetWidth);  // 获取当前窗口大小下的列数 列数要向下取整  	
		var oboxW = box[0].offsetWidth;
		     parent.style.cssText = 'width:'+ oboxW*colNum + 'px;margin:0 auto';
				var boxHArr = new Array();
			for(i=0;i<box.length;i++){				
				if(i<colNum){
					boxHArr.push(box[i].offsetHeight);//获取第一行所有图片的高度
					} else{								
						var boxminH=Math.min.apply(null,boxHArr); //获取第一行图片中最矮的图片的高度
						 console.log(boxHArr,boxminH);
						var minIndex=getMinIndex(boxHArr,boxminH);
							box[i].style.position = 'absolute';					
						    box[i].style.top=boxminH + 'px';
						    box[i].style.left = box[minIndex].offsetLeft + 'px';
						    boxHArr[minIndex] += box[i].offsetHeight;					   					   
					}					
			}							
	}
  function getbyCls(parent,clsname){
	 var clselement = parent.getElementsByTagName('*');
	   	var clsArr = new Array();
	   for(i=0;i<clselement.length;i++){
		   if(clselement[i].className == clsname){
			   clsArr.push(clselement[i]);
			   }
		   }
	 return clsArr;	  
	 }

function getMinIndex(oArr,min){
	for(var i in oArr){
		if(oArr[i] == min){
			return i;
		}
	}	
}

function scrollCk(){
	var oparent=document.getElementById('wrap');
	var obox = getbyCls(oparent,'box');
	var lastBoxH = obox[obox.length-1].offsetTop+ Math.floor(obox[obox.length-1].offsetHeight/2);
	var scrollTop = document.body.scrollTop || document.documentElement.scrollTop;
	var height=document.body.clientHeight || document.documentElement.clientHeight;
	return (lastBoxH < scrollTop + height)? true:false;
	
}

</script>
</head>

<body>
	<div class="container" id="wrap">
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/1.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/2.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/3.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/4.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/5.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/6.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/7.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/8.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/9.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/10.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/11.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/12.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/13.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/14.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/15.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/16.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/17.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/18.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/19.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/19.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/20.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/21.jpg" />
            </div>
        </div>
        
        
    	<div class="box">
        	<div class="pic">
            	<img src="image/22.jpeg" />
            </div>
        </div>
        
        <div class="box">
        	<div class="pic">
            	<img src="image/23.jpg" />
            </div>
        </div>
   
    
       
        <div class="box">
        	<div class="pic">
            	<img src="image/24.jpg" />
            </div>
        </div>
   
    
       
        <div class="box">
        	<div class="pic">
            	<img src="image/25.jpg" />
            </div>
        </div>
   
    
       
        <div class="box">
        	<div class="pic">
            	<img src="image/26.jpg" />
            </div>
        </div>
   
    
       
        <div class="box">
        	<div class="pic">
            	<img src="image/27.jpg" />
            </div>
        </div>
   
    
       
        <div class="box">
        	<div class="pic">
            	<img src="image/28.jpg" />
            </div>
        </div>
   
    
       
        <div class="box">
        	<div class="pic">
            	<img src="image/29.jpg" />
            </div>
        </div>
   
    
       
        <div class="box">
        	<div class="pic">
            	<img src="image/30.jpg" />
            </div>
        </div>
   
    
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/wp.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/wp2.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/wp3.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/wp6.jpg" />
            </div>
        </div>
    
    	<div class="box">
        	<div class="pic">
            	<img src="image/wp7.jpg" />
            </div>
        </div>
    
    
    </div>

</body>
</html>
